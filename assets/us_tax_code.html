<!DOCTYPE html>
<html>
<head>
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.catala-code .hll { background-color: #ffffcc }
.catala-code { background: #f8f8f8; }
.catala-code .c { color: #3D7B7B; font-style: italic } /* Comment */
.catala-code .err { border: 1px solid #FF0000 } /* Error */
.catala-code .k { color: #008000; font-weight: bold } /* Keyword */
.catala-code .o { color: #666666 } /* Operator */
.catala-code .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.catala-code .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.catala-code .cp { color: #9C6500 } /* Comment.Preproc */
.catala-code .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.catala-code .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.catala-code .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.catala-code .gd { color: #A00000 } /* Generic.Deleted */
.catala-code .ge { font-style: italic } /* Generic.Emph */
.catala-code .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.catala-code .gr { color: #E40000 } /* Generic.Error */
.catala-code .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.catala-code .gi { color: #008400 } /* Generic.Inserted */
.catala-code .go { color: #717171 } /* Generic.Output */
.catala-code .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.catala-code .gs { font-weight: bold } /* Generic.Strong */
.catala-code .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.catala-code .gt { color: #0044DD } /* Generic.Traceback */
.catala-code .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.catala-code .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.catala-code .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.catala-code .kp { color: #008000 } /* Keyword.Pseudo */
.catala-code .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.catala-code .kt { color: #B00040 } /* Keyword.Type */
.catala-code .m { color: #666666 } /* Literal.Number */
.catala-code .s { color: #BA2121 } /* Literal.String */
.catala-code .na { color: #687822 } /* Name.Attribute */
.catala-code .nb { color: #008000 } /* Name.Builtin */
.catala-code .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.catala-code .no { color: #880000 } /* Name.Constant */
.catala-code .nd { color: #AA22FF } /* Name.Decorator */
.catala-code .ni { color: #717171; font-weight: bold } /* Name.Entity */
.catala-code .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.catala-code .nf { color: #0000FF } /* Name.Function */
.catala-code .nl { color: #767600 } /* Name.Label */
.catala-code .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.catala-code .nt { color: #008000; font-weight: bold } /* Name.Tag */
.catala-code .nv { color: #19177C } /* Name.Variable */
.catala-code .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.catala-code .w { color: #bbbbbb } /* Text.Whitespace */
.catala-code .mb { color: #666666 } /* Literal.Number.Bin */
.catala-code .mf { color: #666666 } /* Literal.Number.Float */
.catala-code .mh { color: #666666 } /* Literal.Number.Hex */
.catala-code .mi { color: #666666 } /* Literal.Number.Integer */
.catala-code .mo { color: #666666 } /* Literal.Number.Oct */
.catala-code .sa { color: #BA2121 } /* Literal.String.Affix */
.catala-code .sb { color: #BA2121 } /* Literal.String.Backtick */
.catala-code .sc { color: #BA2121 } /* Literal.String.Char */
.catala-code .dl { color: #BA2121 } /* Literal.String.Delimiter */
.catala-code .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.catala-code .s2 { color: #BA2121 } /* Literal.String.Double */
.catala-code .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.catala-code .sh { color: #BA2121 } /* Literal.String.Heredoc */
.catala-code .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.catala-code .sx { color: #008000 } /* Literal.String.Other */
.catala-code .sr { color: #A45A77 } /* Literal.String.Regex */
.catala-code .s1 { color: #BA2121 } /* Literal.String.Single */
.catala-code .ss { color: #19177C } /* Literal.String.Symbol */
.catala-code .bp { color: #008000 } /* Name.Builtin.Pseudo */
.catala-code .fm { color: #0000FF } /* Name.Function.Magic */
.catala-code .vc { color: #19177C } /* Name.Variable.Class */
.catala-code .vg { color: #19177C } /* Name.Variable.Global */
.catala-code .vi { color: #19177C } /* Name.Variable.Instance */
.catala-code .vm { color: #19177C } /* Name.Variable.Magic */
.catala-code .il { color: #666666 } /* Literal.Number.Integer.Long */

</style>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
</head>
<body>
<h1>Legislative text implementation<br />
<small>Document generated by Catala version 0.10.0-28-g372058bc</small>
</h1>
<p>This document was produced from a set of source files written in the
Catala programming language, mixing together the legislative text and
the computer code that translates it. For more information about the
methodology and how to read the code, please visit <a
href="https://catala-lang.org">https://catala-lang.org</a>.</p>
<p>
Source files weaved in this document:
</p>
<ul>
<li><tt>us_tax_code.catala_en</tt>, last modification 2024-05-22, 14:27</li>
<li><tt>preamble.catala_en</tt>, last modification 2024-05-22, 14:27</li>
<li><tt>section_121.catala_en</tt>, last modification 2024-05-22, 14:27</li>
<li><tt>section_132.catala_en</tt>, last modification 2024-05-22, 14:27</li>
</ul>

<details class="toc">
  <summary>Table of contents</summary>
  <ol class="toc-0">
    <li class="toc-item">
      <div>
        <a href="#Master%20file">Master file</a>
        <ol class="toc-1">
          <li class="toc-item">
            <div>
              <a href="#Master%20file-The%20US%20Tax%20Code">The US Tax Code</a>
              <ol class="toc-2">
                
                </ol>
              </div>
            </li>
          <li class="toc-item">
            <div>
              <a href="#Master%20file-Section%20121">Section 121</a>
              <ol class="toc-2">
                <li class="toc-item">
                  <div>
                    <a href="#Master%20file-Section%20121-(a)%20Exclusion">(a) Exclusion</a>
                    <ol class="toc-3">
                      
                      </ol>
                    </div>
                  </li>
                <li class="toc-item">
                  <div>
                    <a href="#Master%20file-Section%20121-(b)%20Limitations">(b) Limitations</a>
                    <ol class="toc-3">
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20121-(b)%20Limitations-(1)%20In%20general">(1) In general</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns">(2) Special rules for joint returns</a>
                          <ol class="toc-4">
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(A)%20$500,000%20Limitation%20for%20certain%20joint%20returns">(A) $500,000 Limitation for certain joint returns</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(B)%20Other%20joint%20returns">(B) Other joint returns</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20121-(b)%20Limitations-(3)%20Application%20to%20only%201%20sale%20or%20exchange%20every%202%20years">(3) Application to only 1 sale or exchange every 2 years</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20121-(b)%20Limitations-(4)%20Special%20rule%20for%20certain%20sales%20by%20surviving%20spouses">(4) Special rule for certain sales by surviving spouses</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use">(5) Exclusion of gain allocated to nonqualified use</a>
                          <ol class="toc-4">
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(A)%20In%20general">(A) In general</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(B)%20Gain%20allocated%20to%20periods%20of%20nonqualified%20use">(B) Gain allocated to periods of nonqualified use</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use">(C) Period of nonqualified use</a>
                                <ol class="toc-5">
                                  <li class="toc-item">
                                    <div>
                                      <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(i)%20In%20general">(i) In general</a>
                                      <ol class="toc-6">
                                        
                                        </ol>
                                      </div>
                                    </li>
                                  <li class="toc-item">
                                    <div>
                                      <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(ii)%20Exceptions">(ii) Exceptions</a>
                                      <ol class="toc-6">
                                        
                                        </ol>
                                      </div>
                                    </li>
                                  </ol>
                                </div>
                              </li>
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(D)%20Coordination%20with%20recognition%20of%20gain%20attributable%20to%20depreciation">(D) Coordination with recognition of gain attributable to depreciation</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            </ol>
                          </div>
                        </li>
                      </ol>
                    </div>
                  </li>
                </ol>
              </div>
            </li>
          <li class="toc-item">
            <div>
              <a href="#Master%20file-Section%20132">Section 132</a>
              <ol class="toc-2">
                <li class="toc-item">
                  <div>
                    <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined">(c) Qualified employee discount defined</a>
                    <ol class="toc-3">
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(1)%20Qualified%20employee%20discount">(1) Qualified employee discount</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage">(2) Gross profit percentage</a>
                          <ol class="toc-4">
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(A)%20In%20general">(A) In general</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            <li class="toc-item">
                              <div>
                                <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(B)%20Determination%20of%20gross%20profit%20percentage">(B) Determination of gross profit percentage</a>
                                <ol class="toc-5">
                                  
                                  </ol>
                                </div>
                              </li>
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(3)%20Employee%20discount%20defined">(3) Employee discount defined</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      <li class="toc-item">
                        <div>
                          <a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(4)%20Qualified%20property%20or%20services">(4) Qualified property or services</a>
                          <ol class="toc-4">
                            
                            </ol>
                          </div>
                        </li>
                      </ol>
                    </div>
                  </li>
                </ol>
              </div>
            </li>
          </ol>
        </div>
      </li>
    </ol>
  </details>
<h1 class='law-heading' id="Master%20file"><a href="#Master%20file">Master file</a></h1>


<h2 class='law-heading' id="Master%20file-The%20US%20Tax%20Code"><a href="#Master%20file-The%20US%20Tax%20Code">The US Tax Code</a></h2>
<details><summary>The US Tax Code</summary>

<div class='code-wrapper code-metadata catala-code'>
<div class='filename'>us_tax_code/preamble.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/preamble.catala_en-4">4</a></span>
<span class="normal"><a href="#us_tax_code/preamble.catala_en-5">5</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/preamble.catala_en-4" name="us_tax_code/preamble.catala_en-4"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">Person</span><span class="o">:</span>
<a id="us_tax_code/preamble.catala_en-5" name="us_tax_code/preamble.catala_en-5"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">id</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">integer</span>
</pre></div></td></tr></table></div>

</div>


</details>
<h2 class='law-heading' id="Master%20file-Section%20121"><a href="#Master%20file-Section%20121">Section 121</a></h2>
<details><summary>Section 121</summary>

<div class='code-wrapper code-metadata catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-4">  4</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-5">  5</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-6">  6</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-7">  7</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-8">  8</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-9">  9</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-10"> 10</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-11"> 11</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-12"> 12</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-13"> 13</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-14"> 14</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-15"> 15</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-16"> 16</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-17"> 17</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-18"> 18</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-19"> 19</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-20"> 20</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-21"> 21</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-22"> 22</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-23"> 23</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-24"> 24</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-25"> 25</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-26"> 26</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-27"> 27</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-28"> 28</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-29"> 29</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-30"> 30</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-31"> 31</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-32"> 32</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-33"> 33</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-34"> 34</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-35"> 35</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-36"> 36</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-37"> 37</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-38"> 38</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-39"> 39</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-40"> 40</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-41"> 41</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-42"> 42</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-43"> 43</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-44"> 44</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-45"> 45</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-46"> 46</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-47"> 47</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-48"> 48</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-49"> 49</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-50"> 50</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-51"> 51</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-52"> 52</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-53"> 53</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-54"> 54</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-55"> 55</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-56"> 56</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-57"> 57</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-58"> 58</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-59"> 59</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-60"> 60</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-61"> 61</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-62"> 62</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-63"> 63</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-64"> 64</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-65"> 65</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-66"> 66</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-67"> 67</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-68"> 68</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-69"> 69</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-70"> 70</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-71"> 71</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-72"> 72</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-73"> 73</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-74"> 74</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-75"> 75</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-76"> 76</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-77"> 77</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-78"> 78</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-79"> 79</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-80"> 80</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-81"> 81</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-82"> 82</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-83"> 83</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-84"> 84</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-85"> 85</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-86"> 86</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-87"> 87</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-88"> 88</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-89"> 89</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-90"> 90</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-91"> 91</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-92"> 92</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-93"> 93</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-94"> 94</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-95"> 95</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-96"> 96</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-97"> 97</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-98"> 98</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-99"> 99</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-100">100</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-101">101</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-102">102</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-103">103</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-104">104</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-105">105</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-106">106</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-107">107</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-108">108</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-109">109</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-110">110</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-111">111</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-112">112</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-113">113</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-114">114</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-115">115</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-116">116</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-117">117</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-118">118</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-119">119</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-120">120</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-121">121</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-122">122</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-123">123</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-124">124</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-125">125</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-126">126</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-127">127</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-128">128</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-129">129</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-130">130</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-131">131</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-132">132</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-133">133</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-134">134</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-135">135</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-136">136</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-137">137</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-138">138</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-139">139</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-140">140</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-141">141</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-142">142</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-143">143</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-144">144</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-145">145</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-146">146</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-147">147</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-148">148</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-149">149</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-150">150</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-151">151</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-152">152</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-153">153</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-154">154</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-155">155</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-156">156</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-157">157</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-158">158</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-4" name="us_tax_code/section_121.catala_en-4"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">Period</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-5" name="us_tax_code/section_121.catala_en-5"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">begin</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-6" name="us_tax_code/section_121.catala_en-6"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">end</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-7" name="us_tax_code/section_121.catala_en-7"></a>
<a id="us_tax_code/section_121.catala_en-8" name="us_tax_code/section_121.catala_en-8"></a><span class="kr">declaration</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">PeriodMerge</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-9" name="us_tax_code/section_121.catala_en-9"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="nv">periods1</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-10" name="us_tax_code/section_121.catala_en-10"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="nv">periods2</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-11" name="us_tax_code/section_121.catala_en-11"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">output_periods</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-12" name="us_tax_code/section_121.catala_en-12"></a>
<a id="us_tax_code/section_121.catala_en-13" name="us_tax_code/section_121.catala_en-13"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">PeriodMerge</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-14" name="us_tax_code/section_121.catala_en-14"></a><span class="c1">  # Placeholders, overwritten by caller</span>
<a id="us_tax_code/section_121.catala_en-15" name="us_tax_code/section_121.catala_en-15"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">periods1</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">[]</span>
<a id="us_tax_code/section_121.catala_en-16" name="us_tax_code/section_121.catala_en-16"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">periods2</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">[]</span>
<a id="us_tax_code/section_121.catala_en-17" name="us_tax_code/section_121.catala_en-17"></a>
<a id="us_tax_code/section_121.catala_en-18" name="us_tax_code/section_121.catala_en-18"></a><span class="c1">  # TODO: find a way to implement the merging of two collections of date</span>
<a id="us_tax_code/section_121.catala_en-19" name="us_tax_code/section_121.catala_en-19"></a><span class="c1">  # periods into a single non-overlapping collection of date periods such</span>
<a id="us_tax_code/section_121.catala_en-20" name="us_tax_code/section_121.catala_en-20"></a><span class="c1">  # that the output covers both input date ranges.</span>
<a id="us_tax_code/section_121.catala_en-21" name="us_tax_code/section_121.catala_en-21"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">output_periods</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">[]</span>
<a id="us_tax_code/section_121.catala_en-22" name="us_tax_code/section_121.catala_en-22"></a>
<a id="us_tax_code/section_121.catala_en-23" name="us_tax_code/section_121.catala_en-23"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">PreviousSaleWhereSection121aApplied</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-24" name="us_tax_code/section_121.catala_en-24"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-25" name="us_tax_code/section_121.catala_en-25"></a>
<a id="us_tax_code/section_121.catala_en-26" name="us_tax_code/section_121.catala_en-26"></a>
<a id="us_tax_code/section_121.catala_en-27" name="us_tax_code/section_121.catala_en-27"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">enumeration</span><span class="s"> </span><span class="nc">OtherSection121aSale</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-28" name="us_tax_code/section_121.catala_en-28"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">NoOtherSaleWhereSection121aApplied</span>
<a id="us_tax_code/section_121.catala_en-29" name="us_tax_code/section_121.catala_en-29"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">MostRecentSaleWhereSection121aApplied</span><span class="s"> </span><span class="kr">content</span>
<a id="us_tax_code/section_121.catala_en-30" name="us_tax_code/section_121.catala_en-30"></a><span class="s">    </span><span class="nc">PreviousSaleWhereSection121aApplied</span>
<a id="us_tax_code/section_121.catala_en-31" name="us_tax_code/section_121.catala_en-31"></a>
<a id="us_tax_code/section_121.catala_en-32" name="us_tax_code/section_121.catala_en-32"></a><span class="kr">declaration</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-33" name="us_tax_code/section_121.catala_en-33"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">requirements_met</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-34" name="us_tax_code/section_121.catala_en-34"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">requirements_ownership_met</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-35" name="us_tax_code/section_121.catala_en-35"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">requirements_usage_met</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-36" name="us_tax_code/section_121.catala_en-36"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-37" name="us_tax_code/section_121.catala_en-37"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">property_ownage</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-38" name="us_tax_code/section_121.catala_en-38"></a><span class="c1">  # Invariant: the periods in the collection are disjoint</span>
<a id="us_tax_code/section_121.catala_en-39" name="us_tax_code/section_121.catala_en-39"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-40" name="us_tax_code/section_121.catala_en-40"></a><span class="s">    </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-41" name="us_tax_code/section_121.catala_en-41"></a><span class="c1">  # Invariant: the periods in the collection are disjoint</span>
<a id="us_tax_code/section_121.catala_en-42" name="us_tax_code/section_121.catala_en-42"></a><span class="s">  </span><span class="kd">internal</span><span class="s"> </span><span class="nv">aggregate_periods_from_last_five_years</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">duration</span>
<a id="us_tax_code/section_121.catala_en-43" name="us_tax_code/section_121.catala_en-43"></a><span class="s">    </span><span class="kr">depends on</span><span class="s"> </span><span class="nv">periods</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-44" name="us_tax_code/section_121.catala_en-44"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="kd">output</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-45" name="us_tax_code/section_121.catala_en-45"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">gain_from_sale_or_exchange_of_property</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-46" name="us_tax_code/section_121.catala_en-46"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-47" name="us_tax_code/section_121.catala_en-47"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-48" name="us_tax_code/section_121.catala_en-48"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="kd">output</span><span class="s"> </span><span class="nv">section_121_b_3_applies</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-49" name="us_tax_code/section_121.catala_en-49"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">other_section_121a_sale</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">OtherSection121aSale</span>
<a id="us_tax_code/section_121.catala_en-50" name="us_tax_code/section_121.catala_en-50"></a>
<a id="us_tax_code/section_121.catala_en-51" name="us_tax_code/section_121.catala_en-51"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">PersonalData</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-52" name="us_tax_code/section_121.catala_en-52"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">property_ownage</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-53" name="us_tax_code/section_121.catala_en-53"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-54" name="us_tax_code/section_121.catala_en-54"></a><span class="s">    </span><span class="kr">content</span><span class="s"> </span><span class="kt">list of</span><span class="s"> </span><span class="nc">Period</span>
<a id="us_tax_code/section_121.catala_en-55" name="us_tax_code/section_121.catala_en-55"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">other_section_121a_sale</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">OtherSection121aSale</span>
<a id="us_tax_code/section_121.catala_en-56" name="us_tax_code/section_121.catala_en-56"></a>
<a id="us_tax_code/section_121.catala_en-57" name="us_tax_code/section_121.catala_en-57"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">JointReturn</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-58" name="us_tax_code/section_121.catala_en-58"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">person1</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-59" name="us_tax_code/section_121.catala_en-59"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">person2</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-60" name="us_tax_code/section_121.catala_en-60"></a>
<a id="us_tax_code/section_121.catala_en-61" name="us_tax_code/section_121.catala_en-61"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">structure</span><span class="s"> </span><span class="nc">DeadSpouseInfo</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-62" name="us_tax_code/section_121.catala_en-62"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">return</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-63" name="us_tax_code/section_121.catala_en-63"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">date_of_spouse_death</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-64" name="us_tax_code/section_121.catala_en-64"></a><span class="s">  </span><span class="kr">data</span><span class="s"> </span><span class="nv">death_spouse_info_at_time_of_death</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-65" name="us_tax_code/section_121.catala_en-65"></a>
<a id="us_tax_code/section_121.catala_en-66" name="us_tax_code/section_121.catala_en-66"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">enumeration</span><span class="s"> </span><span class="nc">ReturnType</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-67" name="us_tax_code/section_121.catala_en-67"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-68" name="us_tax_code/section_121.catala_en-68"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">JointReturn</span>
<a id="us_tax_code/section_121.catala_en-69" name="us_tax_code/section_121.catala_en-69"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">DeadSpouseInfo</span>
<a id="us_tax_code/section_121.catala_en-70" name="us_tax_code/section_121.catala_en-70"></a>
<a id="us_tax_code/section_121.catala_en-71" name="us_tax_code/section_121.catala_en-71"></a><span class="kr">declaration</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-72" name="us_tax_code/section_121.catala_en-72"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="kd">output</span><span class="s"> </span><span class="nv">person1</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-73" name="us_tax_code/section_121.catala_en-73"></a><span class="s">  </span><span class="nv">section121Person1</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span>
<a id="us_tax_code/section_121.catala_en-74" name="us_tax_code/section_121.catala_en-74"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="kd">output</span><span class="s"> </span><span class="nv">person2</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">PersonalData</span>
<a id="us_tax_code/section_121.catala_en-75" name="us_tax_code/section_121.catala_en-75"></a><span class="s">  </span><span class="nv">section121Person2</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span>
<a id="us_tax_code/section_121.catala_en-76" name="us_tax_code/section_121.catala_en-76"></a><span class="s">  </span><span class="kd">internal</span><span class="s"> </span><span class="nv">section121a_requirements_met</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-77" name="us_tax_code/section_121.catala_en-77"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">section_121_b_2_A_condition</span><span class="s"> </span><span class="kr">condition</span>
<a id="us_tax_code/section_121.catala_en-78" name="us_tax_code/section_121.catala_en-78"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">gain_cap_person_1</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-79" name="us_tax_code/section_121.catala_en-79"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">gain_cap_person_2</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-80" name="us_tax_code/section_121.catala_en-80"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-81" name="us_tax_code/section_121.catala_en-81"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">ReturnType</span>
<a id="us_tax_code/section_121.catala_en-82" name="us_tax_code/section_121.catala_en-82"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">return_date</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-83" name="us_tax_code/section_121.catala_en-83"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-84" name="us_tax_code/section_121.catala_en-84"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">gain_from_sale_or_exchange_of_property</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-85" name="us_tax_code/section_121.catala_en-85"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-86" name="us_tax_code/section_121.catala_en-86"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-87" name="us_tax_code/section_121.catala_en-87"></a><span class="s">  </span><span class="nv">period_merge</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">PeriodMerge</span>
<a id="us_tax_code/section_121.catala_en-88" name="us_tax_code/section_121.catala_en-88"></a>
<a id="us_tax_code/section_121.catala_en-89" name="us_tax_code/section_121.catala_en-89"></a><span class="c1"># Defining sub-scopes arguments</span>
<a id="us_tax_code/section_121.catala_en-90" name="us_tax_code/section_121.catala_en-90"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-91" name="us_tax_code/section_121.catala_en-91"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-92" name="us_tax_code/section_121.catala_en-92"></a><span class="s">    </span><span class="nv">date_of_sale_or_exchange</span>
<a id="us_tax_code/section_121.catala_en-93" name="us_tax_code/section_121.catala_en-93"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-94" name="us_tax_code/section_121.catala_en-94"></a><span class="s">    </span><span class="nv">date_of_sale_or_exchange</span>
<a id="us_tax_code/section_121.catala_en-95" name="us_tax_code/section_121.catala_en-95"></a>
<a id="us_tax_code/section_121.catala_en-96" name="us_tax_code/section_121.catala_en-96"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">person1</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-97" name="us_tax_code/section_121.catala_en-97"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_person1</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="nv">data_person1</span>
<a id="us_tax_code/section_121.catala_en-98" name="us_tax_code/section_121.catala_en-98"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_couple</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="nv">data_couple</span><span class="o">.</span><span class="s">person1</span>
<a id="us_tax_code/section_121.catala_en-99" name="us_tax_code/section_121.catala_en-99"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_single</span><span class="o">:</span><span class="s"> </span><span class="nv">data_single</span><span class="o">.</span><span class="s">return</span>
<a id="us_tax_code/section_121.catala_en-100" name="us_tax_code/section_121.catala_en-100"></a>
<a id="us_tax_code/section_121.catala_en-101" name="us_tax_code/section_121.catala_en-101"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">person2</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-102" name="us_tax_code/section_121.catala_en-102"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_person2</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="nv">data_person2</span>
<a id="us_tax_code/section_121.catala_en-103" name="us_tax_code/section_121.catala_en-103"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_couple</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="nv">data_couple</span><span class="o">.</span><span class="s">person2</span>
<a id="us_tax_code/section_121.catala_en-104" name="us_tax_code/section_121.catala_en-104"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">data_single</span><span class="o">:</span><span class="s"> </span><span class="nv">data_single</span><span class="o">.</span><span class="s">return</span>
<a id="us_tax_code/section_121.catala_en-105" name="us_tax_code/section_121.catala_en-105"></a>
<a id="us_tax_code/section_121.catala_en-106" name="us_tax_code/section_121.catala_en-106"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">property_ownage </span><span class="kr">equals</span><span class="s"> </span><span class="nv">person1</span><span class="o">.</span><span class="s">property_ownage</span>
<a id="us_tax_code/section_121.catala_en-107" name="us_tax_code/section_121.catala_en-107"></a>
<a id="us_tax_code/section_121.catala_en-108" name="us_tax_code/section_121.catala_en-108"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">property_usage_as_principal_residence </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-109" name="us_tax_code/section_121.catala_en-109"></a><span class="s">    </span><span class="nv">person1</span><span class="o">.</span><span class="s">property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-110" name="us_tax_code/section_121.catala_en-110"></a>
<a id="us_tax_code/section_121.catala_en-111" name="us_tax_code/section_121.catala_en-111"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">property_ownage </span><span class="kr">equals</span><span class="s"> </span><span class="nv">person2</span><span class="o">.</span><span class="s">property_ownage</span>
<a id="us_tax_code/section_121.catala_en-112" name="us_tax_code/section_121.catala_en-112"></a>
<a id="us_tax_code/section_121.catala_en-113" name="us_tax_code/section_121.catala_en-113"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">property_usage_as_principal_residence </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-114" name="us_tax_code/section_121.catala_en-114"></a><span class="s">    </span><span class="nv">person1</span><span class="o">.</span><span class="s">property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-115" name="us_tax_code/section_121.catala_en-115"></a>
<a id="us_tax_code/section_121.catala_en-116" name="us_tax_code/section_121.catala_en-116"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">gain_from_sale_or_exchange_of_property </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-117" name="us_tax_code/section_121.catala_en-117"></a><span class="s">    </span><span class="nv">gain_from_sale_or_exchange_of_property</span>
<a id="us_tax_code/section_121.catala_en-118" name="us_tax_code/section_121.catala_en-118"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">gain_from_sale_or_exchange_of_property </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-119" name="us_tax_code/section_121.catala_en-119"></a><span class="s">    </span><span class="nv">gain_from_sale_or_exchange_of_property</span>
<a id="us_tax_code/section_121.catala_en-120" name="us_tax_code/section_121.catala_en-120"></a>
<a id="us_tax_code/section_121.catala_en-121" name="us_tax_code/section_121.catala_en-121"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">other_section_121a_sale </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-122" name="us_tax_code/section_121.catala_en-122"></a><span class="s">    </span><span class="nv">person1</span><span class="o">.</span><span class="s">other_section_121a_sale</span>
<a id="us_tax_code/section_121.catala_en-123" name="us_tax_code/section_121.catala_en-123"></a>
<a id="us_tax_code/section_121.catala_en-124" name="us_tax_code/section_121.catala_en-124"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">other_section_121a_sale </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-125" name="us_tax_code/section_121.catala_en-125"></a><span class="s">    </span><span class="nv">person2</span><span class="o">.</span><span class="s">other_section_121a_sale</span>
<a id="us_tax_code/section_121.catala_en-126" name="us_tax_code/section_121.catala_en-126"></a>
<a id="us_tax_code/section_121.catala_en-127" name="us_tax_code/section_121.catala_en-127"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gain_cap_person_1</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">gain_cap</span>
<a id="us_tax_code/section_121.catala_en-128" name="us_tax_code/section_121.catala_en-128"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gain_cap_person_2</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">gain_cap</span>
<a id="us_tax_code/section_121.catala_en-129" name="us_tax_code/section_121.catala_en-129"></a>
<a id="us_tax_code/section_121.catala_en-130" name="us_tax_code/section_121.catala_en-130"></a><span class="kr">declaration</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPasses</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-131" name="us_tax_code/section_121.catala_en-131"></a><span class="s">  </span><span class="nv">first_pass</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span>
<a id="us_tax_code/section_121.catala_en-132" name="us_tax_code/section_121.catala_en-132"></a><span class="s">  </span><span class="nv">second_pass</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span>
<a id="us_tax_code/section_121.catala_en-133" name="us_tax_code/section_121.catala_en-133"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">ReturnType</span>
<a id="us_tax_code/section_121.catala_en-134" name="us_tax_code/section_121.catala_en-134"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">return_date</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-135" name="us_tax_code/section_121.catala_en-135"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">date</span>
<a id="us_tax_code/section_121.catala_en-136" name="us_tax_code/section_121.catala_en-136"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">gain_from_sale_or_exchange_of_property</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-137" name="us_tax_code/section_121.catala_en-137"></a><span class="s">  </span><span class="nv">period_merge</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">PeriodMerge</span>
<a id="us_tax_code/section_121.catala_en-138" name="us_tax_code/section_121.catala_en-138"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_121.catala_en-139" name="us_tax_code/section_121.catala_en-139"></a>
<a id="us_tax_code/section_121.catala_en-140" name="us_tax_code/section_121.catala_en-140"></a><span class="c1"># Defining sub-scopes arguments</span>
<a id="us_tax_code/section_121.catala_en-141" name="us_tax_code/section_121.catala_en-141"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPasses</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-142" name="us_tax_code/section_121.catala_en-142"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">return_type </span><span class="kr">equals</span><span class="s"> </span><span class="nv">return_type</span>
<a id="us_tax_code/section_121.catala_en-143" name="us_tax_code/section_121.catala_en-143"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">return_type </span><span class="kr">equals</span><span class="s"> </span><span class="nv">return_type</span>
<a id="us_tax_code/section_121.catala_en-144" name="us_tax_code/section_121.catala_en-144"></a>
<a id="us_tax_code/section_121.catala_en-145" name="us_tax_code/section_121.catala_en-145"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">return_date </span><span class="kr">equals</span><span class="s"> </span><span class="nv">return_date</span>
<a id="us_tax_code/section_121.catala_en-146" name="us_tax_code/section_121.catala_en-146"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">return_date </span><span class="kr">equals</span><span class="s"> </span><span class="nv">return_date</span>
<a id="us_tax_code/section_121.catala_en-147" name="us_tax_code/section_121.catala_en-147"></a>
<a id="us_tax_code/section_121.catala_en-148" name="us_tax_code/section_121.catala_en-148"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">gain_from_sale_or_exchange_of_property </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-149" name="us_tax_code/section_121.catala_en-149"></a><span class="s">    </span><span class="nv">gain_from_sale_or_exchange_of_property</span>
<a id="us_tax_code/section_121.catala_en-150" name="us_tax_code/section_121.catala_en-150"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">gain_from_sale_or_exchange_of_property </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-151" name="us_tax_code/section_121.catala_en-151"></a><span class="s">    </span><span class="nv">gain_from_sale_or_exchange_of_property</span>
<a id="us_tax_code/section_121.catala_en-152" name="us_tax_code/section_121.catala_en-152"></a>
<a id="us_tax_code/section_121.catala_en-153" name="us_tax_code/section_121.catala_en-153"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="kr">equals</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span>
<a id="us_tax_code/section_121.catala_en-154" name="us_tax_code/section_121.catala_en-154"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-155" name="us_tax_code/section_121.catala_en-155"></a><span class="s">    </span><span class="nv">date_of_sale_or_exchange</span>
<a id="us_tax_code/section_121.catala_en-156" name="us_tax_code/section_121.catala_en-156"></a>
<a id="us_tax_code/section_121.catala_en-157" name="us_tax_code/section_121.catala_en-157"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-158" name="us_tax_code/section_121.catala_en-158"></a><span class="s">    </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">income_excluded_from_gross_income</span>
</pre></div></td></tr></table></div>

</div>

<h3 class='law-heading' id="Master%20file-Section%20121-(a)%20Exclusion"><a href="#Master%20file-Section%20121-(a)%20Exclusion">(a) Exclusion</a></h3>

<div class='law-text'><p>Gross income shall not include gain from the sale or exchange of
property if, during the 5-year period ending on the date of the sale or
exchange, such property has been owned and used by the taxpayer as the
taxpayer’s principal residence for periods aggregating 2 years or
more.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-169">169</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-170">170</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-171">171</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-172">172</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-173">173</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-174">174</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-175">175</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-176">176</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-177">177</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-178">178</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-179">179</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-180">180</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-181">181</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-182">182</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-183">183</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-184">184</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-185">185</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-186">186</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-187">187</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-188">188</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-189">189</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-190">190</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-191">191</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-192">192</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-193">193</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-194">194</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-195">195</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-196">196</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-197">197</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-198">198</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-199">199</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-200">200</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-201">201</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-202">202</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-203">203</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-204">204</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-205">205</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-206">206</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-207">207</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-208">208</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-209">209</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-210">210</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-211">211</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-212">212</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-213">213</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-214">214</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-169" name="us_tax_code/section_121.catala_en-169"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-170" name="us_tax_code/section_121.catala_en-170"></a><span class="c1">  # Here we aggregate over all the periods of the collection. For</span>
<a id="us_tax_code/section_121.catala_en-171" name="us_tax_code/section_121.catala_en-171"></a><span class="c1">  # each period, three cases:</span>
<a id="us_tax_code/section_121.catala_en-172" name="us_tax_code/section_121.catala_en-172"></a><span class="c1">  # - either the period began less that 5 years before the</span>
<a id="us_tax_code/section_121.catala_en-173" name="us_tax_code/section_121.catala_en-173"></a><span class="c1">  #   date_of_sale_or_exchange in which case we count if full</span>
<a id="us_tax_code/section_121.catala_en-174" name="us_tax_code/section_121.catala_en-174"></a><span class="c1">  # - either the period ended more that 5 years before the</span>
<a id="us_tax_code/section_121.catala_en-175" name="us_tax_code/section_121.catala_en-175"></a><span class="c1">  #   date_of_sale_or_exchange in which case we don&#39;t count it</span>
<a id="us_tax_code/section_121.catala_en-176" name="us_tax_code/section_121.catala_en-176"></a><span class="c1">  # - either the 5 years mark is inside the period and we only</span>
<a id="us_tax_code/section_121.catala_en-177" name="us_tax_code/section_121.catala_en-177"></a><span class="c1">  #   cound the half after 5 years</span>
<a id="us_tax_code/section_121.catala_en-178" name="us_tax_code/section_121.catala_en-178"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">aggregate_periods_from_last_five_years</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">periods</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-179" name="us_tax_code/section_121.catala_en-179"></a><span class="s">    </span><span class="kd">sum</span><span class="s"> </span><span class="kt">duration</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="o">(</span>
<a id="us_tax_code/section_121.catala_en-180" name="us_tax_code/section_121.catala_en-180"></a><span class="s">      </span><span class="kd">if</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="o">&lt;=</span><span class="s"> </span><span class="nv">period</span><span class="o">.</span><span class="s">begin </span><span class="o">+</span><span class="s"> </span><span class="mi">5</span><span class="s"> </span><span class="o">year</span><span class="s"> </span><span class="kd">then</span>
<a id="us_tax_code/section_121.catala_en-181" name="us_tax_code/section_121.catala_en-181"></a><span class="s">        </span><span class="nv">period</span><span class="o">.</span><span class="s">end </span><span class="o">-</span><span class="s"> </span><span class="nv">period</span><span class="o">.</span><span class="s">begin</span>
<a id="us_tax_code/section_121.catala_en-182" name="us_tax_code/section_121.catala_en-182"></a><span class="s">      </span><span class="kd">else</span><span class="s"> </span><span class="o">(</span><span class="kd">if</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="nv">period</span><span class="o">.</span><span class="s">end </span><span class="o">+</span><span class="s"> </span><span class="mi">5</span><span class="s"> </span><span class="o">year</span><span class="s"> </span><span class="kd">then</span>
<a id="us_tax_code/section_121.catala_en-183" name="us_tax_code/section_121.catala_en-183"></a><span class="s">        </span><span class="mi">0</span><span class="s"> </span><span class="o">day</span>
<a id="us_tax_code/section_121.catala_en-184" name="us_tax_code/section_121.catala_en-184"></a><span class="s">      </span><span class="kd">else</span><span class="s"> </span><span class="o">((</span><span class="nv">period</span><span class="o">.</span><span class="s">end </span><span class="o">+</span><span class="s"> </span><span class="mi">5</span><span class="s"> </span><span class="o">year)</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="o">))</span>
<a id="us_tax_code/section_121.catala_en-185" name="us_tax_code/section_121.catala_en-185"></a><span class="s">    </span><span class="o">)</span>
<a id="us_tax_code/section_121.catala_en-186" name="us_tax_code/section_121.catala_en-186"></a><span class="s">    </span><span class="kd">for</span><span class="s"> </span><span class="nv">period</span><span class="s"> </span><span class="kd">among</span><span class="s"> </span><span class="nv">periods</span>
<a id="us_tax_code/section_121.catala_en-187" name="us_tax_code/section_121.catala_en-187"></a>
<a id="us_tax_code/section_121.catala_en-188" name="us_tax_code/section_121.catala_en-188"></a><span class="c1">  # Regulation 1.121-1(c)(1): 2 years = 730 days</span>
<a id="us_tax_code/section_121.catala_en-189" name="us_tax_code/section_121.catala_en-189"></a><span class="c1">  # Regulation 1.121-1(c)(1): the periods of ownage and usage</span>
<a id="us_tax_code/section_121.catala_en-190" name="us_tax_code/section_121.catala_en-190"></a><span class="c1">  # don&#39;t have to overlap</span>
<a id="us_tax_code/section_121.catala_en-191" name="us_tax_code/section_121.catala_en-191"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">requirements_ownership_met</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-192" name="us_tax_code/section_121.catala_en-192"></a><span class="s">    </span><span class="nv">aggregate_periods_from_last_five_years</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">property_ownage</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="mi">730</span><span class="s"> </span><span class="o">day</span>
<a id="us_tax_code/section_121.catala_en-193" name="us_tax_code/section_121.catala_en-193"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-194" name="us_tax_code/section_121.catala_en-194"></a>
<a id="us_tax_code/section_121.catala_en-195" name="us_tax_code/section_121.catala_en-195"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">requirements_usage_met</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-196" name="us_tax_code/section_121.catala_en-196"></a><span class="s">    </span><span class="nv">aggregate_periods_from_last_five_years</span><span class="s"> </span><span class="kd">of</span>
<a id="us_tax_code/section_121.catala_en-197" name="us_tax_code/section_121.catala_en-197"></a><span class="s">       </span><span class="nv">property_usage_as_principal_residence</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="mi">730</span><span class="s"> </span><span class="o">day</span>
<a id="us_tax_code/section_121.catala_en-198" name="us_tax_code/section_121.catala_en-198"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-199" name="us_tax_code/section_121.catala_en-199"></a>
<a id="us_tax_code/section_121.catala_en-200" name="us_tax_code/section_121.catala_en-200"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">requirements_met</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-201" name="us_tax_code/section_121.catala_en-201"></a><span class="s">    </span><span class="nv">requirements_ownership_met</span><span class="s"> </span><span class="o">and</span><span class="s"> </span><span class="nv">requirements_usage_met</span>
<a id="us_tax_code/section_121.catala_en-202" name="us_tax_code/section_121.catala_en-202"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-203" name="us_tax_code/section_121.catala_en-203"></a>
<a id="us_tax_code/section_121.catala_en-204" name="us_tax_code/section_121.catala_en-204"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-205" name="us_tax_code/section_121.catala_en-205"></a><span class="s">    </span><span class="kd">if</span><span class="s"> </span><span class="nv">requirements_met</span><span class="s"> </span><span class="kd">then</span><span class="s"> </span><span class="nv">gain_from_sale_or_exchange_of_property</span>
<a id="us_tax_code/section_121.catala_en-206" name="us_tax_code/section_121.catala_en-206"></a><span class="s">    </span><span class="kd">else</span><span class="s"> </span><span class="o">$</span><span class="mi">0</span>
<a id="us_tax_code/section_121.catala_en-207" name="us_tax_code/section_121.catala_en-207"></a>
<a id="us_tax_code/section_121.catala_en-208" name="us_tax_code/section_121.catala_en-208"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-209" name="us_tax_code/section_121.catala_en-209"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">section121a_requirements_met</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-210" name="us_tax_code/section_121.catala_en-210"></a><span class="s">    </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">requirements_met</span>
<a id="us_tax_code/section_121.catala_en-211" name="us_tax_code/section_121.catala_en-211"></a>
<a id="us_tax_code/section_121.catala_en-212" name="us_tax_code/section_121.catala_en-212"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-213" name="us_tax_code/section_121.catala_en-213"></a><span class="s">    </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">income_excluded_from_gross_income_uncapped</span>
<a id="us_tax_code/section_121.catala_en-214" name="us_tax_code/section_121.catala_en-214"></a>
</pre></div></td></tr></table></div>

</div>


<h3 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations"><a href="#Master%20file-Section%20121-(b)%20Limitations">(b) Limitations</a></h3>


<h4 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(1)%20In%20general"><a href="#Master%20file-Section%20121-(b)%20Limitations-(1)%20In%20general">(1) In general</a></h4>

<div class='law-text'><p>The amount of gain excluded from gross income under subsection (a)
with respect to any sale or exchange shall not exceed $250,000.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-225">225</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-226">226</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-227">227</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-228">228</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-229">229</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-230">230</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-231">231</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-232">232</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-233">233</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-234">234</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-235">235</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-236">236</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-237">237</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-238">238</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-239">239</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-240">240</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-241">241</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-242">242</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-243">243</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-244">244</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-225" name="us_tax_code/section_121.catala_en-225"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-226" name="us_tax_code/section_121.catala_en-226"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">$</span><span class="mi">250,000</span>
<a id="us_tax_code/section_121.catala_en-227" name="us_tax_code/section_121.catala_en-227"></a>
<a id="us_tax_code/section_121.catala_en-228" name="us_tax_code/section_121.catala_en-228"></a><span class="c1">  # Big semantics insight for Catala. Here we could want to get rid of</span>
<a id="us_tax_code/section_121.catala_en-229" name="us_tax_code/section_121.catala_en-229"></a><span class="c1">  # the &quot;_uncapped&quot; version of the variable. But in the current</span>
<a id="us_tax_code/section_121.catala_en-230" name="us_tax_code/section_121.catala_en-230"></a><span class="c1">  # semantics we can&#39;t do that because we don&#39;t allow for recursion.</span>
<a id="us_tax_code/section_121.catala_en-231" name="us_tax_code/section_121.catala_en-231"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-232" name="us_tax_code/section_121.catala_en-232"></a><span class="s">    </span><span class="kd">if</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kd">then</span>
<a id="us_tax_code/section_121.catala_en-233" name="us_tax_code/section_121.catala_en-233"></a><span class="s">      </span><span class="nv">gain_cap</span>
<a id="us_tax_code/section_121.catala_en-234" name="us_tax_code/section_121.catala_en-234"></a><span class="s">    </span><span class="kd">else</span>
<a id="us_tax_code/section_121.catala_en-235" name="us_tax_code/section_121.catala_en-235"></a><span class="s">      </span><span class="nv">income_excluded_from_gross_income_uncapped</span>
<a id="us_tax_code/section_121.catala_en-236" name="us_tax_code/section_121.catala_en-236"></a>
<a id="us_tax_code/section_121.catala_en-237" name="us_tax_code/section_121.catala_en-237"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-238" name="us_tax_code/section_121.catala_en-238"></a><span class="s">    </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">gain_cap</span>
<a id="us_tax_code/section_121.catala_en-239" name="us_tax_code/section_121.catala_en-239"></a>
<a id="us_tax_code/section_121.catala_en-240" name="us_tax_code/section_121.catala_en-240"></a><span class="s">    </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-241" name="us_tax_code/section_121.catala_en-241"></a><span class="s">    </span><span class="kd">if</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kd">then</span>
<a id="us_tax_code/section_121.catala_en-242" name="us_tax_code/section_121.catala_en-242"></a><span class="s">      </span><span class="nv">gain_cap</span>
<a id="us_tax_code/section_121.catala_en-243" name="us_tax_code/section_121.catala_en-243"></a><span class="s">    </span><span class="kd">else</span>
<a id="us_tax_code/section_121.catala_en-244" name="us_tax_code/section_121.catala_en-244"></a><span class="s">      </span><span class="nv">income_excluded_from_gross_income_uncapped</span>
</pre></div></td></tr></table></div>

</div>


<h4 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns"><a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns">(2) Special rules for joint returns</a></h4>

<div class='law-text'><p>In the case of a husband and wife who make a joint return for the
taxable year of the sale or exchange of the property—</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-253">253</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-254">254</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-255">255</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-256">256</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-253" name="us_tax_code/section_121.catala_en-253"></a><span class="c1"># Taxable year of the sale or exchange ?=? year when the income is taxed</span>
<a id="us_tax_code/section_121.catala_en-254" name="us_tax_code/section_121.catala_en-254"></a><span class="c1"># Imagine a couple selling the house in 2020 and getting the payment in</span>
<a id="us_tax_code/section_121.catala_en-255" name="us_tax_code/section_121.catala_en-255"></a><span class="c1"># 2021 where they file a joint return. Does (A) apply or not ?</span>
<a id="us_tax_code/section_121.catala_en-256" name="us_tax_code/section_121.catala_en-256"></a><span class="c1"># Reasonably it should.</span>
</pre></div></td></tr></table></div>

</div>

<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(A)%20$500,000%20Limitation%20for%20certain%20joint%20returns"><a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(A)%20$500,000%20Limitation%20for%20certain%20joint%20returns">(A) $500,000 Limitation for certain joint returns</a></h5>

<div class='law-text'><p>Paragraph (1) shall be applied by substituting “$500,000” for
“$250,000” if—</p>
<ol type="i">
<li><p>either spouse meets the ownership requirements of subsection (a)
with respect to such property;</p></li>
<li><p>both spouses meet the use requirements of subsection (a) with
respect to such property; and</p></li>
<li><p>neither spouse is ineligible for the benefits of subsection (a)
with respect to such property by reason of paragraph (3).</p></li>
</ol></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-273">273</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-274">274</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-275">275</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-276">276</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-277">277</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-278">278</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-279">279</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-280">280</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-281">281</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-282">282</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-283">283</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-284">284</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-285">285</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-286">286</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-287">287</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-288">288</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-289">289</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-290">290</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-291">291</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-292">292</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-293">293</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-294">294</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-295">295</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-296">296</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-297">297</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-298">298</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-299">299</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-273" name="us_tax_code/section_121.catala_en-273"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPersons</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-274" name="us_tax_code/section_121.catala_en-274"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">section_121_b_2_A_condition</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-275" name="us_tax_code/section_121.catala_en-275"></a><span class="s">  </span><span class="o">(</span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span><span class="s"> </span><span class="nc">JointReturn</span><span class="o">)</span>
<a id="us_tax_code/section_121.catala_en-276" name="us_tax_code/section_121.catala_en-276"></a><span class="s">  </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-277" name="us_tax_code/section_121.catala_en-277"></a><span class="c1">  # i)</span>
<a id="us_tax_code/section_121.catala_en-278" name="us_tax_code/section_121.catala_en-278"></a><span class="s">  </span><span class="o">(</span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">requirements_ownership_met </span><span class="o">or</span>
<a id="us_tax_code/section_121.catala_en-279" name="us_tax_code/section_121.catala_en-279"></a><span class="s">     </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">requirements_ownership_met</span><span class="o">)</span>
<a id="us_tax_code/section_121.catala_en-280" name="us_tax_code/section_121.catala_en-280"></a><span class="s">  </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-281" name="us_tax_code/section_121.catala_en-281"></a><span class="c1">  # ii)</span>
<a id="us_tax_code/section_121.catala_en-282" name="us_tax_code/section_121.catala_en-282"></a><span class="s">  </span><span class="o">(</span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">requirements_usage_met </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-283" name="us_tax_code/section_121.catala_en-283"></a><span class="s">     </span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">requirements_usage_met</span><span class="o">)</span>
<a id="us_tax_code/section_121.catala_en-284" name="us_tax_code/section_121.catala_en-284"></a><span class="c1">  # iii)</span>
<a id="us_tax_code/section_121.catala_en-285" name="us_tax_code/section_121.catala_en-285"></a><span class="s">  </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-286" name="us_tax_code/section_121.catala_en-286"></a><span class="s">  </span><span class="o">(not</span><span class="s"> </span><span class="o">(</span><span class="nv">section121Person1</span><span class="o">.</span><span class="s">section_121_b_3_applies</span><span class="o">))</span>
<a id="us_tax_code/section_121.catala_en-287" name="us_tax_code/section_121.catala_en-287"></a><span class="s">  </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-288" name="us_tax_code/section_121.catala_en-288"></a><span class="s">  </span><span class="o">(not</span><span class="s"> </span><span class="o">(</span><span class="nv">section121Person2</span><span class="o">.</span><span class="s">section_121_b_3_applies</span><span class="o">))</span>
<a id="us_tax_code/section_121.catala_en-289" name="us_tax_code/section_121.catala_en-289"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-290" name="us_tax_code/section_121.catala_en-290"></a>
<a id="us_tax_code/section_121.catala_en-291" name="us_tax_code/section_121.catala_en-291"></a><span class="s">  </span><span class="kr">exception</span>
<a id="us_tax_code/section_121.catala_en-292" name="us_tax_code/section_121.catala_en-292"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">section121a_requirements_met</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-293" name="us_tax_code/section_121.catala_en-293"></a><span class="s">    </span><span class="nv">section_121_b_2_A_condition</span>
<a id="us_tax_code/section_121.catala_en-294" name="us_tax_code/section_121.catala_en-294"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-295" name="us_tax_code/section_121.catala_en-295"></a>
<a id="us_tax_code/section_121.catala_en-296" name="us_tax_code/section_121.catala_en-296"></a><span class="s">  </span><span class="kr">exception</span>
<a id="us_tax_code/section_121.catala_en-297" name="us_tax_code/section_121.catala_en-297"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gain_cap</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-298" name="us_tax_code/section_121.catala_en-298"></a><span class="s">    </span><span class="nv">section_121_b_2_A_condition</span>
<a id="us_tax_code/section_121.catala_en-299" name="us_tax_code/section_121.catala_en-299"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">$</span><span class="mi">500,000</span>
</pre></div></td></tr></table></div>

</div>


<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(B)%20Other%20joint%20returns"><a href="#Master%20file-Section%20121-(b)%20Limitations-(2)%20Special%20rules%20for%20joint%20returns-(B)%20Other%20joint%20returns">(B) Other joint returns</a></h5>

<div class='law-text'><p>If such spouses do not meet the requirements of subparagraph (A), the
limitation under paragraph (1) shall be the sum of the limitations under
paragraph (1) to which each spouse would be entitled if such spouses had
not been married. For purposes of the preceding sentence, each spouse
shall be treated as owning the property during the period that either
spouse owned the property.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-311">311</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-312">312</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-313">313</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-314">314</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-315">315</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-316">316</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-317">317</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-318">318</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-319">319</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-320">320</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-321">321</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-322">322</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-323">323</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-324">324</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-325">325</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-326">326</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-327">327</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-328">328</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-329">329</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-330">330</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-331">331</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-332">332</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-333">333</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-334">334</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-335">335</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-336">336</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-337">337</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-338">338</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-339">339</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-311" name="us_tax_code/section_121.catala_en-311"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPasses</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-312" name="us_tax_code/section_121.catala_en-312"></a><span class="s">  </span><span class="o">(</span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span><span class="s"> </span><span class="nc">JointReturn</span><span class="o">)</span><span class="s"> </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-313" name="us_tax_code/section_121.catala_en-313"></a><span class="s">  </span><span class="o">not</span><span class="s"> </span><span class="o">(</span><span class="nv">first_pass</span><span class="o">.</span><span class="s">section_121_b_2_A_condition</span><span class="o">):</span>
<a id="us_tax_code/section_121.catala_en-314" name="us_tax_code/section_121.catala_en-314"></a>
<a id="us_tax_code/section_121.catala_en-315" name="us_tax_code/section_121.catala_en-315"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">gain_cap </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-316" name="us_tax_code/section_121.catala_en-316"></a><span class="s">    </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">gain_cap_person_1 </span><span class="o">+</span>
<a id="us_tax_code/section_121.catala_en-317" name="us_tax_code/section_121.catala_en-317"></a><span class="s">    </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">gain_cap_person_2</span>
<a id="us_tax_code/section_121.catala_en-318" name="us_tax_code/section_121.catala_en-318"></a>
<a id="us_tax_code/section_121.catala_en-319" name="us_tax_code/section_121.catala_en-319"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">period_merge</span><span class="o">.</span><span class="s">periods1 </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-320" name="us_tax_code/section_121.catala_en-320"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">joint_return</span><span class="o">:</span><span class="s"> </span><span class="nv">joint_return</span><span class="o">.</span><span class="s">person1.property_ownage</span>
<a id="us_tax_code/section_121.catala_en-321" name="us_tax_code/section_121.catala_en-321"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">dead_spouse_info</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="o">[]</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-322" name="us_tax_code/section_121.catala_en-322"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="o">[]</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-323" name="us_tax_code/section_121.catala_en-323"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">period_merge</span><span class="o">.</span><span class="s">periods2 </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-324" name="us_tax_code/section_121.catala_en-324"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">joint_return</span><span class="o">:</span><span class="s"> </span><span class="nv">joint_return</span><span class="o">.</span><span class="s">person2.property_ownage</span>
<a id="us_tax_code/section_121.catala_en-325" name="us_tax_code/section_121.catala_en-325"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">dead_spouse_info</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="o">[]</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-326" name="us_tax_code/section_121.catala_en-326"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="s"> </span><span class="o">:</span><span class="s"> </span><span class="o">[]</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-327" name="us_tax_code/section_121.catala_en-327"></a>
<a id="us_tax_code/section_121.catala_en-328" name="us_tax_code/section_121.catala_en-328"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">person1 </span><span class="kr">equals</span><span class="s"> </span><span class="nc">PersonalData</span><span class="s"> </span><span class="o">{</span>
<a id="us_tax_code/section_121.catala_en-329" name="us_tax_code/section_121.catala_en-329"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">property_ownage</span><span class="o">:</span><span class="s"> </span><span class="nv">period_merge</span><span class="o">.</span><span class="s">output_periods</span>
<a id="us_tax_code/section_121.catala_en-330" name="us_tax_code/section_121.catala_en-330"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">property_usage_as_principal_residence</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-331" name="us_tax_code/section_121.catala_en-331"></a><span class="s">      </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">person1.property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-332" name="us_tax_code/section_121.catala_en-332"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">other_section_121a_sale</span><span class="o">:</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">person1.other_section_121a_sale</span>
<a id="us_tax_code/section_121.catala_en-333" name="us_tax_code/section_121.catala_en-333"></a><span class="s">  </span><span class="o">}</span>
<a id="us_tax_code/section_121.catala_en-334" name="us_tax_code/section_121.catala_en-334"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">person2 </span><span class="kr">equals</span><span class="s"> </span><span class="nc">PersonalData</span><span class="s"> </span><span class="o">{</span>
<a id="us_tax_code/section_121.catala_en-335" name="us_tax_code/section_121.catala_en-335"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">property_ownage</span><span class="o">:</span><span class="s"> </span><span class="nv">period_merge</span><span class="o">.</span><span class="s">output_periods</span>
<a id="us_tax_code/section_121.catala_en-336" name="us_tax_code/section_121.catala_en-336"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">property_usage_as_principal_residence</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-337" name="us_tax_code/section_121.catala_en-337"></a><span class="s">      </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">person2.property_usage_as_principal_residence</span>
<a id="us_tax_code/section_121.catala_en-338" name="us_tax_code/section_121.catala_en-338"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nv">other_section_121a_sale</span><span class="o">:</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">person2.other_section_121a_sale</span>
<a id="us_tax_code/section_121.catala_en-339" name="us_tax_code/section_121.catala_en-339"></a><span class="s">  </span><span class="o">}</span>
</pre></div></td></tr></table></div>

</div>



<h4 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(3)%20Application%20to%20only%201%20sale%20or%20exchange%20every%202%20years"><a href="#Master%20file-Section%20121-(b)%20Limitations-(3)%20Application%20to%20only%201%20sale%20or%20exchange%20every%202%20years">(3) Application to only 1 sale or exchange every 2 years</a></h4>

<div class='law-text'><p>Subsection (a) shall not apply to any sale or exchange by the
taxpayer if, during the 2-year period ending on the date of such sale or
exchange, there was any other sale or exchange by the taxpayer to which
subsection (a) applied.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-350">350</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-351">351</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-352">352</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-353">353</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-354">354</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-355">355</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-356">356</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-357">357</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-358">358</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-359">359</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-360">360</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-350" name="us_tax_code/section_121.catala_en-350"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121SinglePerson</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-351" name="us_tax_code/section_121.catala_en-351"></a><span class="s">  </span><span class="kr">rule</span><span class="s"> </span><span class="nv">section_121_b_3_applies</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-352" name="us_tax_code/section_121.catala_en-352"></a><span class="s">    </span><span class="nv">other_section_121a_sale</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-353" name="us_tax_code/section_121.catala_en-353"></a><span class="s">       </span><span class="nc">MostRecentSaleWhereSection121aApplied</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">other_sale</span><span class="s"> </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-354" name="us_tax_code/section_121.catala_en-354"></a><span class="s">    </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">other_sale</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="o">&lt;=</span><span class="s"> </span><span class="mi">2</span><span class="s"> </span><span class="o">year</span>
<a id="us_tax_code/section_121.catala_en-355" name="us_tax_code/section_121.catala_en-355"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">fulfilled</span>
<a id="us_tax_code/section_121.catala_en-356" name="us_tax_code/section_121.catala_en-356"></a>
<a id="us_tax_code/section_121.catala_en-357" name="us_tax_code/section_121.catala_en-357"></a><span class="s">  </span><span class="kr">exception</span>
<a id="us_tax_code/section_121.catala_en-358" name="us_tax_code/section_121.catala_en-358"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">income_excluded_from_gross_income_uncapped</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-359" name="us_tax_code/section_121.catala_en-359"></a><span class="s">    </span><span class="nv">section_121_b_3_applies</span>
<a id="us_tax_code/section_121.catala_en-360" name="us_tax_code/section_121.catala_en-360"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">$</span><span class="mi">0</span>
</pre></div></td></tr></table></div>

</div>


<h4 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(4)%20Special%20rule%20for%20certain%20sales%20by%20surviving%20spouses"><a href="#Master%20file-Section%20121-(b)%20Limitations-(4)%20Special%20rule%20for%20certain%20sales%20by%20surviving%20spouses">(4) Special rule for certain sales by surviving spouses</a></h4>


<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-366">366</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-367">367</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-366" name="us_tax_code/section_121.catala_en-366"></a><span class="c1"># Sarah: the year when your spouse dies, do you file a joint return or</span>
<a id="us_tax_code/section_121.catala_en-367" name="us_tax_code/section_121.catala_en-367"></a><span class="c1"># separate returns?</span>
</pre></div></td></tr></table></div>

</div>
<div class='law-text'><p>In the case of a sale or exchange of property by an unmarried
individual whose spouse is deceased on the date of such sale, paragraph
(1) shall be applied by substituting “$500,000” for “$250,000” if such
sale occurs not later than 2 years after the date of death of such
spouse and the requirements of paragraph (2)(A) were met immediately
before such date of death.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_121.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-376">376</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-377">377</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-378">378</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-379">379</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-380">380</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-381">381</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-382">382</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-383">383</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-384">384</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-385">385</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-386">386</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-387">387</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-388">388</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-389">389</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-390">390</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-391">391</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-392">392</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-393">393</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-394">394</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-395">395</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-396">396</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-397">397</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-398">398</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-399">399</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-400">400</a></span>
<span class="normal"><a href="#us_tax_code/section_121.catala_en-401">401</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_121.catala_en-376" name="us_tax_code/section_121.catala_en-376"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">Section121TwoPasses</span><span class="s"> </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-377" name="us_tax_code/section_121.catala_en-377"></a><span class="s">  </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">single_data</span><span class="s"> </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-378" name="us_tax_code/section_121.catala_en-378"></a><span class="s">  </span><span class="nv">single_data</span><span class="o">.</span><span class="s">date_of_spouse_death </span><span class="o">&lt;</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="o">and</span>
<a id="us_tax_code/section_121.catala_en-379" name="us_tax_code/section_121.catala_en-379"></a><span class="s">  </span><span class="nv">date_of_sale_or_exchange</span><span class="s"> </span><span class="o">&lt;=</span><span class="s"> </span><span class="nv">single_data</span><span class="o">.</span><span class="s">date_of_spouse_death </span><span class="o">+</span><span class="s"> </span><span class="mi">2</span><span class="s"> </span><span class="o">year</span>
<a id="us_tax_code/section_121.catala_en-380" name="us_tax_code/section_121.catala_en-380"></a><span class="s">  </span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-381" name="us_tax_code/section_121.catala_en-381"></a>
<a id="us_tax_code/section_121.catala_en-382" name="us_tax_code/section_121.catala_en-382"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">date_of_sale_or_exchange </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-383" name="us_tax_code/section_121.catala_en-383"></a><span class="s">    </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-384" name="us_tax_code/section_121.catala_en-384"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">single_data</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-385" name="us_tax_code/section_121.catala_en-385"></a><span class="s">      </span><span class="nv">single_data</span><span class="o">.</span><span class="s">date_of_spouse_death</span>
<a id="us_tax_code/section_121.catala_en-386" name="us_tax_code/section_121.catala_en-386"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="o">:</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-387" name="us_tax_code/section_121.catala_en-387"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="o">:</span><span class="s"> </span><span class="nv">date_of_sale_or_exchange</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-388" name="us_tax_code/section_121.catala_en-388"></a>
<a id="us_tax_code/section_121.catala_en-389" name="us_tax_code/section_121.catala_en-389"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">return_type </span><span class="kr">equals</span>
<a id="us_tax_code/section_121.catala_en-390" name="us_tax_code/section_121.catala_en-390"></a><span class="s">    </span><span class="kr">match</span><span class="s"> </span><span class="nv">return_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_121.catala_en-391" name="us_tax_code/section_121.catala_en-391"></a><span class="s">      </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturnSurvivingSpouse</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">single_data</span><span class="o">:</span>
<a id="us_tax_code/section_121.catala_en-392" name="us_tax_code/section_121.catala_en-392"></a><span class="s">        </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="o">(</span><span class="nc">JointReturn</span><span class="s"> </span><span class="o">{</span>
<a id="us_tax_code/section_121.catala_en-393" name="us_tax_code/section_121.catala_en-393"></a><span class="s">          </span><span class="o">--</span><span class="s"> </span><span class="nv">person1</span><span class="o">:</span><span class="s"> </span><span class="nv">single_data</span><span class="o">.</span><span class="s">return</span>
<a id="us_tax_code/section_121.catala_en-394" name="us_tax_code/section_121.catala_en-394"></a><span class="s">          </span><span class="o">--</span><span class="s"> </span><span class="nv">person2</span><span class="o">:</span><span class="s"> </span><span class="nv">single_data</span><span class="o">.</span><span class="s">death_spouse_info_at_time_of_death</span>
<a id="us_tax_code/section_121.catala_en-395" name="us_tax_code/section_121.catala_en-395"></a><span class="s">        </span><span class="o">})</span>
<a id="us_tax_code/section_121.catala_en-396" name="us_tax_code/section_121.catala_en-396"></a><span class="s">      </span><span class="o">--</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="o">:</span><span class="s"> </span><span class="nc">SingleReturn</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nv">return</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-397" name="us_tax_code/section_121.catala_en-397"></a><span class="s">      </span><span class="o">--</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kd">of</span><span class="s"> </span><span class="nv">return</span><span class="o">:</span><span class="s"> </span><span class="nc">JointReturn</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nv">return</span><span class="c1"> # does not happen</span>
<a id="us_tax_code/section_121.catala_en-398" name="us_tax_code/section_121.catala_en-398"></a>
<a id="us_tax_code/section_121.catala_en-399" name="us_tax_code/section_121.catala_en-399"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">second_pass</span><span class="o">.</span><span class="s">gain_cap </span><span class="kr">under condition</span>
<a id="us_tax_code/section_121.catala_en-400" name="us_tax_code/section_121.catala_en-400"></a><span class="s">     </span><span class="nv">first_pass</span><span class="o">.</span><span class="s">section_121_b_2_A_condition</span>
<a id="us_tax_code/section_121.catala_en-401" name="us_tax_code/section_121.catala_en-401"></a><span class="s">  </span><span class="kr">consequence</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">$</span><span class="mi">500,000</span>
</pre></div></td></tr></table></div>

</div>


<h4 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use">(5) Exclusion of gain allocated to nonqualified use</a></h4>


<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(A)%20In%20general"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(A)%20In%20general">(A) In general</a></h5>

<div class='law-text'><p>Subsection (a) shall not apply to so much of the gain from the sale
or exchange of property as is allocated to periods of nonqualified
use.</p></div>

<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(B)%20Gain%20allocated%20to%20periods%20of%20nonqualified%20use"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(B)%20Gain%20allocated%20to%20periods%20of%20nonqualified%20use">(B) Gain allocated to periods of nonqualified use</a></h5>

<div class='law-text'><p>For purposes of subparagraph (A), gain shall be allocated to periods
of nonqualified use based on the ratio which—</p>
<ol type="i">
<li><p>the aggregate periods of nonqualified use during the period such
property was owned by the taxpayer, bears to</p></li>
<li><p>the period such property was owned by the taxpayer.</p></li>
</ol></div>

<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use">(C) Period of nonqualified use</a></h5>

<div class='law-text'><p>For purposes of this paragraph—</p></div>
<h6 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(i)%20In%20general"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(i)%20In%20general">(i) In general</a></h6>

<div class='law-text'><p>The term “period of nonqualified use” means any period (other than
the portion of any period preceding January 1, 2009) during which the
property is not used as the principal residence of the taxpayer or the
taxpayer’s spouse or former spouse.</p></div>

<h6 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(ii)%20Exceptions"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(C)%20Period%20of%20nonqualified%20use-(ii)%20Exceptions">(ii) Exceptions</a></h6>

<div class='law-text'><p>The term “period of nonqualified use” does not include—</p>
<ol type="I">
<li><p>any portion of the 5-year period described in subsection (a)
which is after the last date that such property is used as the principal
residence of the taxpayer or the taxpayer’s spouse,</p></li>
<li><p>any period (not to exceed an aggregate period of 10 years) during
which the taxpayer or the taxpayer’s spouse is serving on qualified
official extended duty (as defined in subsection (d)(9)(C)) described in
clause (i), (ii), or (iii) of subsection (d)(9)(A), and</p></li>
<li><p>any other period of temporary absence (not to exceed an aggregate
period of 2 years) due to change of employment, health conditions, or
such other unforeseen circumstances as may be specified by the
Secretary.</p></li>
</ol></div>


<h5 class='law-heading' id="Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(D)%20Coordination%20with%20recognition%20of%20gain%20attributable%20to%20depreciation"><a href="#Master%20file-Section%20121-(b)%20Limitations-(5)%20Exclusion%20of%20gain%20allocated%20to%20nonqualified%20use-(D)%20Coordination%20with%20recognition%20of%20gain%20attributable%20to%20depreciation">(D) Coordination with recognition of gain attributable to depreciation</a></h5>

<div class='law-text'><p>For purposes of this paragraph—</p>
<ol type="i">
<li><p>subparagraph (A) shall be applied after the application of
subsection (d)(6), and</p></li>
<li><p>subparagraph (B) shall be applied without regard to any gain to
which subsection (d)(6) applies.</p></li>
</ol></div>




</details>
<h2 class='law-heading' id="Master%20file-Section%20132"><a href="#Master%20file-Section%20132">Section 132</a></h2>
<details><summary>Section 132</summary>

<div class='code-wrapper code-metadata catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-4"> 4</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-5"> 5</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-6"> 6</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-7"> 7</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-8"> 8</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-9"> 9</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-10">10</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-11">11</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-12">12</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-13">13</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-14">14</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-15">15</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-16">16</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-17">17</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-18">18</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-19">19</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-20">20</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-21">21</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-22">22</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-23">23</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-24">24</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-25">25</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-26">26</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-4" name="us_tax_code/section_132.catala_en-4"></a><span class="c1"># We only formalize part (c) here</span>
<a id="us_tax_code/section_132.catala_en-5" name="us_tax_code/section_132.catala_en-5"></a><span class="kr">declaration</span><span class="s"> </span><span class="kt">enumeration</span><span class="s"> </span><span class="nc">DiscountType</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-6" name="us_tax_code/section_132.catala_en-6"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">Property</span>
<a id="us_tax_code/section_132.catala_en-7" name="us_tax_code/section_132.catala_en-7"></a><span class="s">  </span><span class="o">--</span><span class="s"> </span><span class="nc">Services</span>
<a id="us_tax_code/section_132.catala_en-8" name="us_tax_code/section_132.catala_en-8"></a>
<a id="us_tax_code/section_132.catala_en-9" name="us_tax_code/section_132.catala_en-9"></a><span class="kr">declaration</span><span class="s"> </span><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-10" name="us_tax_code/section_132.catala_en-10"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">customer_price</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_132.catala_en-11" name="us_tax_code/section_132.catala_en-11"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">employee_price</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_132.catala_en-12" name="us_tax_code/section_132.catala_en-12"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">gross_profit_percentage</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">decimal</span>
<a id="us_tax_code/section_132.catala_en-13" name="us_tax_code/section_132.catala_en-13"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">qualified_employee_discount</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_132.catala_en-14" name="us_tax_code/section_132.catala_en-14"></a><span class="s">  </span><span class="kd">output</span><span class="s"> </span><span class="nv">employee_discount</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_132.catala_en-15" name="us_tax_code/section_132.catala_en-15"></a><span class="s">  </span><span class="kd">context</span><span class="s"> </span><span class="nv">aggregate_cost</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">money</span>
<a id="us_tax_code/section_132.catala_en-16" name="us_tax_code/section_132.catala_en-16"></a><span class="s">  </span><span class="kd">input</span><span class="s"> </span><span class="nv">discount_type</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="nc">DiscountType</span>
<a id="us_tax_code/section_132.catala_en-17" name="us_tax_code/section_132.catala_en-17"></a><span class="s">  </span><span class="kd">internal</span><span class="s"> </span><span class="nv">is_property</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">boolean</span>
<a id="us_tax_code/section_132.catala_en-18" name="us_tax_code/section_132.catala_en-18"></a><span class="s">  </span><span class="kd">internal</span><span class="s"> </span><span class="nv">is_services</span><span class="s"> </span><span class="kr">content</span><span class="s"> </span><span class="kt">boolean</span>
<a id="us_tax_code/section_132.catala_en-19" name="us_tax_code/section_132.catala_en-19"></a>
<a id="us_tax_code/section_132.catala_en-20" name="us_tax_code/section_132.catala_en-20"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-21" name="us_tax_code/section_132.catala_en-21"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">is_property</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">discount_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_132.catala_en-22" name="us_tax_code/section_132.catala_en-22"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">Property</span><span class="o">:</span><span class="s"> </span><span class="kc">true</span>
<a id="us_tax_code/section_132.catala_en-23" name="us_tax_code/section_132.catala_en-23"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">Services</span><span class="o">:</span><span class="s"> </span><span class="kc">false</span>
<a id="us_tax_code/section_132.catala_en-24" name="us_tax_code/section_132.catala_en-24"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">is_services</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="kr">match</span><span class="s"> </span><span class="nv">discount_type</span><span class="s"> </span><span class="kr">with pattern</span>
<a id="us_tax_code/section_132.catala_en-25" name="us_tax_code/section_132.catala_en-25"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">Property</span><span class="o">:</span><span class="s"> </span><span class="kc">false</span>
<a id="us_tax_code/section_132.catala_en-26" name="us_tax_code/section_132.catala_en-26"></a><span class="s">    </span><span class="o">--</span><span class="s"> </span><span class="nc">Services</span><span class="o">:</span><span class="s"> </span><span class="kc">true</span>
</pre></div></td></tr></table></div>

</div>

<h3 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined">(c) Qualified employee discount defined</a></h3>

<div class='law-text'><p>For purposes of this section—</p></div>
<h4 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(1)%20Qualified%20employee%20discount"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(1)%20Qualified%20employee%20discount">(1) Qualified employee discount</a></h4>

<div class='law-text'><p>The term “qualified employee discount” means any employee discount
with respect to qualified property or services to the extent such
discount does not exceed— (A) in the case of property, the gross profit
percentage of the price at which the property is being offered by the
employer to customers, or</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-40">40</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-41">41</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-42">42</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-43">43</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-44">44</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-45">45</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-46">46</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-47">47</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-40" name="us_tax_code/section_132.catala_en-40"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="s"> </span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-41" name="us_tax_code/section_132.catala_en-41"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">qualified_employee_discount</span>
<a id="us_tax_code/section_132.catala_en-42" name="us_tax_code/section_132.catala_en-42"></a><span class="s">    </span><span class="kr">under condition</span><span class="s"> </span><span class="nv">is_property</span><span class="s"> </span><span class="kr">consequence</span>
<a id="us_tax_code/section_132.catala_en-43" name="us_tax_code/section_132.catala_en-43"></a><span class="s">  </span><span class="kr">equals</span>
<a id="us_tax_code/section_132.catala_en-44" name="us_tax_code/section_132.catala_en-44"></a><span class="s">    </span><span class="kd">if</span><span class="s"> </span><span class="nv">employee_discount</span><span class="s"> </span><span class="o">&gt;</span>
<a id="us_tax_code/section_132.catala_en-45" name="us_tax_code/section_132.catala_en-45"></a><span class="s">      </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">*</span><span class="s"> </span><span class="nv">gross_profit_percentage</span>
<a id="us_tax_code/section_132.catala_en-46" name="us_tax_code/section_132.catala_en-46"></a><span class="s">    </span><span class="kd">then</span><span class="s"> </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">*</span><span class="s"> </span><span class="nv">gross_profit_percentage</span>
<a id="us_tax_code/section_132.catala_en-47" name="us_tax_code/section_132.catala_en-47"></a><span class="s">    </span><span class="kd">else</span><span class="s"> </span><span class="nv">employee_discount</span>
</pre></div></td></tr></table></div>

</div>
<div class='law-text'><ol start="2" type="A">
<li>in the case of services, 20 percent of the price at which the
services are being offered by the employer to customers.</li>
</ol></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-54">54</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-55">55</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-56">56</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-57">57</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-58">58</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-59">59</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-60">60</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-61">61</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-62">62</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-63">63</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-64">64</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-65">65</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-66">66</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-67">67</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-54" name="us_tax_code/section_132.catala_en-54"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="s"> </span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-55" name="us_tax_code/section_132.catala_en-55"></a><span class="kr">definition</span><span class="s"> </span><span class="nv">qualified_employee_discount</span>
<a id="us_tax_code/section_132.catala_en-56" name="us_tax_code/section_132.catala_en-56"></a><span class="s">  </span><span class="kr">under condition</span><span class="s"> </span><span class="nv">is_services</span><span class="s"> </span><span class="kr">consequence</span>
<a id="us_tax_code/section_132.catala_en-57" name="us_tax_code/section_132.catala_en-57"></a><span class="kr">equals</span>
<a id="us_tax_code/section_132.catala_en-58" name="us_tax_code/section_132.catala_en-58"></a><span class="s">  </span><span class="kd">if</span><span class="s"> </span><span class="nv">employee_discount</span><span class="s"> </span><span class="o">&gt;</span>
<a id="us_tax_code/section_132.catala_en-59" name="us_tax_code/section_132.catala_en-59"></a><span class="s">    </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">*</span><span class="s"> </span><span class="mi">20</span><span class="o">%</span>
<a id="us_tax_code/section_132.catala_en-60" name="us_tax_code/section_132.catala_en-60"></a><span class="s">  </span><span class="kd">then</span><span class="s"> </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">*</span><span class="s"> </span><span class="mi">20</span><span class="o">%</span>
<a id="us_tax_code/section_132.catala_en-61" name="us_tax_code/section_132.catala_en-61"></a><span class="s">  </span><span class="kd">else</span><span class="s"> </span><span class="nv">employee_discount</span>
<a id="us_tax_code/section_132.catala_en-62" name="us_tax_code/section_132.catala_en-62"></a>
<a id="us_tax_code/section_132.catala_en-63" name="us_tax_code/section_132.catala_en-63"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="s"> </span><span class="kr">under condition</span><span class="s"> </span><span class="nv">is_services</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-64" name="us_tax_code/section_132.catala_en-64"></a><span class="c1">    # When selling a service, one does not need the aggregate cost.</span>
<a id="us_tax_code/section_132.catala_en-65" name="us_tax_code/section_132.catala_en-65"></a><span class="c1">    # We provide a default value here so that the computations run smooth.</span>
<a id="us_tax_code/section_132.catala_en-66" name="us_tax_code/section_132.catala_en-66"></a><span class="s">    </span><span class="kr">definition</span><span class="s"> </span><span class="nv">aggregate_cost</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="o">$</span><span class="mi">0</span>
<a id="us_tax_code/section_132.catala_en-67" name="us_tax_code/section_132.catala_en-67"></a><span class="s">    </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gross_profit_percentage</span><span class="s"> </span><span class="kr">equals</span><span class="s"> </span><span class="mi">0</span><span class="o">%</span>
</pre></div></td></tr></table></div>

</div>


<h4 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage">(2) Gross profit percentage</a></h4>


<h5 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(A)%20In%20general"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(A)%20In%20general">(A) In general</a></h5>

<div class='law-text'><p>The term “gross profit percentage” means the percent which—</p>
<ol type="i">
<li><p>the excess of the aggregate sales price of property sold by the
employer to customers over the aggregate cost of such property to the
employer, is of</p></li>
<li><p>the aggregate sale price of such property.</p></li>
</ol></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-82">82</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-83">83</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-84">84</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-85">85</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-86">86</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-82" name="us_tax_code/section_132.catala_en-82"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="s"> </span><span class="kr">under condition</span><span class="s"> </span><span class="nv">is_property</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-83" name="us_tax_code/section_132.catala_en-83"></a><span class="s">  </span><span class="kr">assertion</span><span class="s"> </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="nv">aggregate_cost</span>
<a id="us_tax_code/section_132.catala_en-84" name="us_tax_code/section_132.catala_en-84"></a>
<a id="us_tax_code/section_132.catala_en-85" name="us_tax_code/section_132.catala_en-85"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">gross_profit_percentage</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_132.catala_en-86" name="us_tax_code/section_132.catala_en-86"></a><span class="s">    </span><span class="o">(</span><span class="nv">customer_price</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">aggregate_cost</span><span class="o">)</span><span class="s"> </span><span class="o">/</span><span class="s"> </span><span class="nv">customer_price</span>
</pre></div></td></tr></table></div>

</div>


<h5 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(B)%20Determination%20of%20gross%20profit%20percentage"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(2)%20Gross%20profit%20percentage-(B)%20Determination%20of%20gross%20profit%20percentage">(B) Determination of gross profit percentage</a></h5>

<div class='law-text'><p>Gross profit percentage shall be determined on the basis of—</p>
<ol type="i">
<li><p>all property offered to customers in the ordinary course of the
line of business of the employer in which the employee is performing
services (or a reasonable classification of property selected by the
employer), and</p></li>
<li><p>the employer’s experience during a representative
period.</p></li>
</ol></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-100">100</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-101">101</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-100" name="us_tax_code/section_132.catala_en-100"></a><span class="c1"># (i) and (ii) are subjective criteria for determining the gross profit</span>
<a id="us_tax_code/section_132.catala_en-101" name="us_tax_code/section_132.catala_en-101"></a><span class="c1"># percentage ; we do not formalize them</span>
</pre></div></td></tr></table></div>

</div>



<h4 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(3)%20Employee%20discount%20defined"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(3)%20Employee%20discount%20defined">(3) Employee discount defined</a></h4>

<div class='law-text'><p>The term “employee discount” means the amount by which—</p>
<ol type="A">
<li><p>the price at which the property or services are provided by the
employer to an employee for use by such employee, is less than</p></li>
<li><p>the price at which such property or services are being offered by
the employer to customers.</p></li>
</ol></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-115">115</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-116">116</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-117">117</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-118">118</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-119">119</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-115" name="us_tax_code/section_132.catala_en-115"></a><span class="kr">scope</span><span class="s"> </span><span class="nc">QualifiedEmployeeDiscount</span><span class="o">:</span>
<a id="us_tax_code/section_132.catala_en-116" name="us_tax_code/section_132.catala_en-116"></a><span class="s">  </span><span class="kr">assertion</span><span class="s"> </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">&gt;=</span><span class="s"> </span><span class="nv">employee_price</span>
<a id="us_tax_code/section_132.catala_en-117" name="us_tax_code/section_132.catala_en-117"></a>
<a id="us_tax_code/section_132.catala_en-118" name="us_tax_code/section_132.catala_en-118"></a><span class="s">  </span><span class="kr">definition</span><span class="s"> </span><span class="nv">employee_discount</span><span class="s"> </span><span class="kr">equals</span>
<a id="us_tax_code/section_132.catala_en-119" name="us_tax_code/section_132.catala_en-119"></a><span class="s">    </span><span class="nv">customer_price</span><span class="s"> </span><span class="o">-</span><span class="s"> </span><span class="nv">employee_price</span>
</pre></div></td></tr></table></div>

</div>


<h4 class='law-heading' id="Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(4)%20Qualified%20property%20or%20services"><a href="#Master%20file-Section%20132-(c)%20Qualified%20employee%20discount%20defined-(4)%20Qualified%20property%20or%20services">(4) Qualified property or services</a></h4>

<div class='law-text'><p>The term “qualified property or services” means any property (other
than real property and other than personal property of a kind held for
investment) or services which are offered for sale to customers in the
ordinary course of the line of business of the employer in which the
employee is performing services.</p></div>
<div class='code-wrapper catala-code'>
<div class='filename'>us_tax_code/section_132.catala_en</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-131">131</a></span>
<span class="normal"><a href="#us_tax_code/section_132.catala_en-132">132</a></span>
</pre></div></td><td class="code"><div><pre>
<a id="us_tax_code/section_132.catala_en-131" name="us_tax_code/section_132.catala_en-131"></a><span class="c1"># Again, this is for subjectively determining what item qualifies for a</span>
<a id="us_tax_code/section_132.catala_en-132" name="us_tax_code/section_132.catala_en-132"></a><span class="c1"># discount, not formalizing</span>
</pre></div></td></tr></table></div>

</div>



</details>

</body>
</html>
